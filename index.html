<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>손내향미 예약 연습</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 50px;
    }
    #countdown, #triggerButton, #timeButtons, #message, #retryButton {
      margin-top: 20px;
    }
    #triggerButton {
      background-color: orange;
      color: white;
      padding: 10px 20px;
      font-size: 18px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #retryButton {
      background-color: gray;
      color: white;
      padding: 8px 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      display: none;
    }
    #timeButtons button {
      margin: 5px;
      padding: 10px;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <h1>손내향미 예약 연습</h1>
  <button id="startButton">시작하기</button>
  <div id="countdown"></div>
  <div id="triggerButtonContainer"></div>
  <div id="timeButtons" style="display: none;">
    <button>12:00</button>
    <button>12:30</button>
    <button>13:30</button>
    <button>14:00</button>
  </div>
  <div id="message"></div>
  <button id="retryButton">재도전하시겠습니까?</button>

  <script>
    const startButton = document.getElementById("startButton");
    const countdown = document.getElementById("countdown");
    const triggerButtonContainer = document.getElementById("triggerButtonContainer");
    const timeButtons = document.getElementById("timeButtons");
    const message = document.getElementById("message");
    const retryButton = document.getElementById("retryButton");

    let triggerShownAt = null;

    startButton.addEventListener("click", () => {
      countdown.textContent = "예약 오픈 대기 중...";
      message.textContent = "";
      timeButtons.style.display = "none";
      triggerButtonContainer.innerHTML = "";
      retryButton.style.display = "none";

      let timeLeft = 5;
      const interval = setInterval(() => {
        countdown.textContent = `${timeLeft}초 후 예약 가능!`;
        timeLeft--;
        if (timeLeft < 0) {
          clearInterval(interval);
          countdown.textContent = "";
          showTriggerButton();
        }
      }, 1000);
    });

    function showTriggerButton() {
      const button = document.createElement("button");
      button.textContent = "예약하기!";
      button.id = "triggerButton";
      triggerButtonContainer.appendChild(button);
      triggerShownAt = performance.now();

      button.addEventListener("click", () => {
        const clickedAt = performance.now();
        const diff = clickedAt - triggerShownAt;

        if (diff <= 350) {
          timeButtons.style.display = "block";
          triggerButtonContainer.innerHTML = "";
        } else {
          message.textContent = "실패! 너무 늦었습니다.";
          retryButton.style.display = "inline-block";
          triggerButtonContainer.innerHTML = "";
        }
      });
    }

    retryButton.addEventListener("click", () => {
      retryButton.style.display = "none";
      countdown.textContent = "";
      message.textContent = "";
      timeButtons.style.display = "none";
      triggerButtonContainer.innerHTML = "";
    });
  </script>
</body>
</html>
